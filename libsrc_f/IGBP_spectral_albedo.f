

! source from http://www-surf.larc.nasa.gov/surf/pages/ftp-page.html
! translated with vf90 from fortran90 to fortran77
! edited all function names:
!   1st all function names in lowercase
!     (c is case sensitive, fortran is not)
!   2nd removed all underscores "_" from function names
!     (as compiles adds an additional _ 
!      if there is an _ in the function name) 


      BLOCK DATA spectral_dat_bd 
      INCLUDE 'IGBP_spectral_albedo.inc'
 
      DATA SPECALBIGBP/ 0.032, 0.032, 0.032, 0.032, 0.032, 0.032, 0.032
     1   , 0.032, 0.046, 0.046, 0.235, 0.096, 0.038, 0.038, 0.038, 0.044
     2   , 0.044, 0.044, 0.044, 0.044, 0.044, 0.044, 0.044, 0.044, 0.044
     3   , 0.234, 0.193, 0.112, 0.112, 0.112, 0.032, 0.032, 0.032, 0.032
     4   , 0.032, 0.032, 0.032, 0.032, 0.046, 0.046, 0.235, 0.096, 0.038
     5   , 0.038, 0.038, 0.034, 0.034, 0.034, 0.034, 0.034, 0.034, 0.034
     6   , 0.034, 0.066, 0.067, 0.312, 0.276, 0.160, 0.160, 0.160, 0.033
     7   , 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.056, 0.057
     8   , 0.274, 0.186, 0.099, 0.099, 0.099, 0.010, 0.010, 0.010, 0.015
     9   , 0.017, 0.020, 0.036, 0.045, 0.154, 0.156, 0.350, 0.239, 0.101
     .   , 0.101, 0.101, 0.095, 0.095, 0.095, 0.095, 0.095, 0.095, 0.098
     1   , 0.104, 0.122, 0.157, 0.231, 0.330, 0.311, 0.150, 0.150, 0.020
     2   , 0.020, 0.020, 0.023, 0.024, 0.026, 0.035, 0.041, 0.102, 0.104
     3   , 0.366, 0.291, 0.151, 0.107, 0.107, 0.010, 0.010, 0.010, 0.015
     4   , 0.017, 0.020, 0.036, 0.045, 0.126, 0.129, 0.402, 0.301, 0.145
     5   , 0.071, 0.071, 0.010, 0.010, 0.010, 0.015, 0.017, 0.020, 0.036
     6   , 0.045, 0.126, 0.129, 0.402, 0.301, 0.145, 0.071, 0.071, 0.039
     7   , 0.039, 0.039, 0.039, 0.039, 0.039, 0.039, 0.039, 0.051, 0.071
     8   , 0.164, 0.100, 0.056, 0.056, 0.056, 0.010, 0.010, 0.010, 0.015
     9   , 0.017, 0.020, 0.036, 0.045, 0.115, 0.099, 0.442, 0.271, 0.122
     .   , 0.059, 0.059, 0.052, 0.052, 0.052, 0.052, 0.052, 0.052, 0.052
     1   , 0.066, 0.104, 0.114, 0.304, 0.258, 0.258, 0.258, 0.258, 0.010
     2   , 0.010, 0.010, 0.015, 0.017, 0.020, 0.036, 0.045, 0.090, 0.083
     3   , 0.377, 0.273, 0.141, 0.110, 0.110, 0.910, 0.910, 0.910, 0.916
     4   , 0.921, 0.931, 0.947, 0.964, 0.953, 0.920, 0.635, 0.013, 0.006
     5   , 0.009, 0.014, 0.144, 0.144, 0.144, 0.144, 0.144, 0.144, 0.144
     6   , 0.179, 0.263, 0.331, 0.405, 0.390, 0.390, 0.390, 0.390, 0.066
     7   , 0.066, 0.066, 0.070, 0.073, 0.082, 0.094, 0.091, 0.078, 0.072
     8   , 0.066, 0.062, 0.055, 0.044, 0.069, 0.010, 0.010, 0.010, 0.015
     9   , 0.017, 0.020, 0.036, 0.045, 0.113, 0.115, 0.247, 0.265, 0.265
     .   , 0.265, 0.265, 0.979, 0.979, 0.979, 0.980, 0.982, 0.984, 0.988
     1   , 0.992, 0.989, 0.982, 0.902, 0.143, 0.168, 0.019, 0.015, 0.778
     2   , 0.778, 0.778, 0.778, 0.778, 0.778, 0.778, 0.778, 0.778, 0.752
     3   , 0.393, 0.055, 0.054, 0.036, 0.036/ 
C                                                !(20) SEA ICE
      DATA EMISSTBL/ 0.989, 0.989, 0.990, 0.991, 0.991, 0.990, 0.990, 
     1   0.995, 1.000, 1.000, 1.000, 1.000, 0.989, 0.989, 0.990, 0.991, 
     2   0.991, 0.990, 0.990, 0.995, 1.000, 1.000, 1.000, 1.000, 0.985, 
     3   0.986, 0.984, 0.983, 0.979, 0.980, 0.973, 0.987, 1.000, 1.000, 
     4   1.000, 1.000, 0.985, 0.986, 0.984, 0.983, 0.979, 0.980, 0.973, 
     5   0.987, 1.000, 1.000, 1.000, 1.000, 0.987, 0.987, 0.987, 0.987, 
     6   0.985, 0.985, 0.982, 0.991, 1.000, 1.000, 1.000, 1.000, 0.949, 
     7   0.970, 0.974, 0.971, 0.947, 0.958, 0.966, 0.975, 0.984, 0.984, 
     8   0.984, 0.984, 0.873, 0.934, 0.944, 0.939, 0.873, 0.904, 0.936, 
     9   0.942, 0.951, 0.951, 0.951, 0.951, 0.987, 0.990, 0.992, 0.993, 
     .   0.983, 0.975, 0.985, 0.993, 1.000, 1.000, 1.000, 1.000, 0.987, 
     1   0.990, 0.992, 0.993, 0.983, 0.975, 0.985, 0.993, 1.000, 1.000, 
     2   1.000, 1.000, 0.987, 0.990, 0.992, 0.993, 0.983, 0.975, 0.985, 
     3   0.993, 1.000, 1.000, 1.000, 1.000, 0.983, 0.987, 0.987, 0.988, 
     4   0.983, 0.981, 0.987, 0.982, 0.986, 0.986, 0.986, 0.986, 0.987, 
     5   0.990, 0.992, 0.993, 0.983, 0.975, 0.985, 0.993, 1.000, 1.000, 
     6   1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 
     7   1.000, 1.000, 1.000, 1.000, 1.000, 0.987, 0.989, 0.989, 0.990, 
     8   0.984, 0.980, 0.983, 0.992, 1.000, 1.000, 1.000, 1.000, 1.000, 
     9   1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 0.999, 0.999, 0.999, 
     .   0.999, 0.999, 0.835, 0.916, 0.934, 0.923, 0.835, 0.877, 0.921, 
     1   0.926, 0.934, 0.934, 0.934, 0.934, 0.979, 0.983, 0.982, 0.982, 
     2   0.984, 0.987, 0.989, 0.972, 0.972, 0.972, 0.972, 0.972, 0.947, 
     3   0.967, 0.988, 0.979, 0.975, 0.977, 0.992, 0.989, 0.989, 0.989, 
     4   0.989, 0.989, 0.988, 0.988, 0.988, 0.988, 0.988, 0.988, 0.988, 
     5   0.988, 0.988, 0.988, 0.988, 0.988, 0.979, 0.979, 0.979, 0.979, 
     6   0.979, 0.979, 0.979, 0.979, 0.979, 0.979, 0.979, 0.979/ 
      END 
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!
C                                                ! O
      SUBROUTINE getemiss(IGBP, EMS12)
C...Translated by Pacific-Sierra Research vf90 Personal 3.4N5 16:25:20 9/11/06
C...Switches:                     
      INCLUDE 'IGBP_spectral_albedo.inc'
      INTEGER IGBP
      REAL EMS12(12)
      INTEGER J1

      D(1) = 0.40
      D(2) = 0.44
      D(3) = 0.32
      D(4) = 0.39
      D(5) = 0.22
      D(6) = 0.28
      D(7) = 0.40
      D(8) = 0.47
      D(9) = 0.53
      D(10) = 0.53
      D(11) = 0.35
      D(12) = 0.41
      D(13) = 0.10
      D(14) = 0.40
      D(15) = 0.10
      D(16) = 0.40
      D(17) = 0.41
      D(18) = 0.58
      D(19) = 0.10
      D(20) = 0.10
      DO J1 = 1, 12
         EMS12(J1) = EMISSTBL(J1,IGBP)
      END DO
!
!
      END 
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!
C                                                ! O
      SUBROUTINE landspec(IGBP, U0, WV, SALB15, BBALB)
C...Translated by Pacific-Sierra Research vf90 Personal 3.4N5 16:25:20 9/11/06
C...Switches:                     
      INCLUDE 'IGBP_spectral_albedo.inc'
      REAL BBALB
      INTEGER IGBP
      REAL SALB15(15)
      REAL U0
      REAL WV
!
      INTEGER I
      REAL WGTS(15)
      REAL ZENADJ
      REAL R1
      INTEGER J2

      D(1) = 0.40
      D(2) = 0.44
      D(3) = 0.32
      D(4) = 0.39
      D(5) = 0.22
      D(6) = 0.28
      D(7) = 0.40
      D(8) = 0.47
      D(9) = 0.53
      D(10) = 0.53
      D(11) = 0.35
      D(12) = 0.41
      D(13) = 0.10
      D(14) = 0.40
      D(15) = 0.10
      D(16) = 0.40
      D(17) = 0.41
      D(18) = 0.58
      D(19) = 0.10
      D(20) = 0.10

      ZENADJ = (1.0 + D(IGBP))/(1.0 + 2.0*D(IGBP)*U0)
      DO J2 = 1, 15
         SALB15(J2) = SPECALBIGBP(J2,IGBP)*ZENADJ
      END DO
      DO J2 = 1, 15
         IF (SALB15(J2) .GT. 1.0) SALB15(J2) = 1.0
      END DO
      DO J2 = 1, 15
         IF (SALB15(J2) .LT. 0.0) SALB15(J2) = 0.0
      END DO
!
      CALL swdnwgts (U0, WV, WGTS) ! O
!
      R1 = 0
      DO J2 = 1, 15
         R1 = R1 + WGTS(J2)*SALB15(J2)
      END DO
      BBALB = R1
!
!
      END 
!
! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
!
C                                                ! O
      SUBROUTINE swdnwgts(CSZ, PW, WGT)
C...Translated by Pacific-Sierra Research vf90 Personal 3.4N5 16:25:20 9/11/06
C...Switches:                     
      INCLUDE 'IGBP_spectral_albedo.inc'
      REAL WGTS(15,4,3), WGT(15)
      REAL LNPWS(3), CSZS(4)
      REAL YW(2), XW(2), CSZ, PW, LNPW, A1, A2
      INTEGER I, IW, XL(2), YL(2)
      INTEGER J3
      DATA WGTS/ 1.793E-26, 1.427E-28, 4.677E-14, 4.706E-06, 3.297E-03, 
     1   1.653E-02, 7.526E-02, 9.746E-02, 1.573E-01, 1.534E-01, 
     2   3.855E-01, 7.185E-02, 3.084E-02, 4.141E-03, 4.468E-03, 
     3   3.422E-28, 1.070E-30, 1.849E-15, 1.920E-06, 2.667E-03, 
     4   1.501E-02, 7.254E-02, 9.664E-02, 1.577E-01, 1.550E-01, 
     5   3.894E-01, 7.199E-02, 3.066E-02, 3.910E-03, 4.486E-03, 
     6   2.351E-29, 8.316E-32, 1.851E-17, 2.713E-08, 9.317E-04, 
     7   9.006E-03, 5.932E-02, 9.118E-02, 1.572E-01, 1.613E-01, 
     8   4.096E-01, 7.373E-02, 3.014E-02, 3.123E-03, 4.509E-03, 
     9   5.614E-30, 2.067E-32, 4.499E-18, 1.748E-09, 3.743E-05, 
     .   1.207E-03, 2.406E-02, 6.307E-02, 1.365E-01, 1.687E-01, 
     1   4.834E-01, 8.611E-02, 3.055E-02, 2.080E-03, 4.327E-03, 
     2   3.575E-29, 0.000E+00, 6.410E-19, 3.645E-07, 2.449E-03, 
     3   1.538E-02, 7.025E-02, 9.050E-02, 1.444E-01, 1.416E-01, 
     4   3.973E-01, 8.968E-02, 3.600E-02, 7.953E-03, 4.502E-03, 
     5   9.025E-31, 0.000E+00, 6.506E-21, 1.069E-07, 1.945E-03, 
     6   1.393E-02, 6.758E-02, 8.945E-02, 1.441E-01, 1.425E-01, 
     7   4.026E-01, 8.963E-02, 3.602E-02, 7.771E-03, 4.541E-03, 
     8   7.959E-32, 0.000E+00, 2.160E-22, 7.293E-10, 6.241E-04, 
     9   8.289E-03, 5.477E-02, 8.329E-02, 1.403E-01, 1.454E-01, 
     .   4.285E-01, 9.087E-02, 3.622E-02, 7.051E-03, 4.706E-03, 
     1   1.719E-32, 0.000E+00, 5.086E-23, 1.147E-10, 2.030E-05, 
     2   1.081E-03, 2.166E-02, 5.544E-02, 1.126E-01, 1.427E-01, 
     3   5.142E-01, 1.035E-01, 3.836E-02, 5.457E-03, 5.027E-03, 
     4   3.910E-16, 1.975E-27, 9.897E-18, 9.722E-07, 3.687E-03, 
     5   1.942E-02, 7.475E-02, 8.861E-02, 1.359E-01, 1.307E-01, 
     6   3.785E-01, 1.130E-01, 3.848E-02, 1.268E-02, 4.279E-03, 
     7   2.326E-17, 1.286E-29, 1.353E-19, 3.318E-07, 3.150E-03, 
     8   1.849E-02, 7.339E-02, 8.814E-02, 1.354E-01, 1.308E-01, 
     9   3.817E-01, 1.134E-01, 3.863E-02, 1.253E-02, 4.311E-03, 
     .   1.727E-18, 1.177E-30, 3.400E-21, 2.601E-09, 1.469E-03, 
     1   1.432E-02, 6.665E-02, 8.549E-02, 1.322E-01, 1.309E-01, 
     2   3.974E-01, 1.156E-01, 3.954E-02, 1.206E-02, 4.453E-03, 
     3   3.439E-19, 2.483E-31, 7.044E-22, 2.676E-10, 1.108E-04, 
     4   4.962E-03, 4.327E-02, 7.201E-02, 1.147E-01, 1.262E-01, 
     5   4.537E-01, 1.254E-01, 4.305E-02, 1.170E-02, 4.912E-03/ 
      DATA LNPWS/ 1.009, -0.830,  - 3.730/ 
      DATA CSZS/ 1.00000, 0.86603, 0.50000, 0.17365/ 
      D(1) = 0.40
      D(2) = 0.44
      D(3) = 0.32
      D(4) = 0.39
      D(5) = 0.22
      D(6) = 0.28
      D(7) = 0.40
      D(8) = 0.47
      D(9) = 0.53
      D(10) = 0.53
      D(11) = 0.35
      D(12) = 0.41
      D(13) = 0.10
      D(14) = 0.40
      D(15) = 0.10
      D(16) = 0.40
      D(17) = 0.41
      D(18) = 0.58
      D(19) = 0.10
      D(20) = 0.10
      LNPW = LOG(PW)                             !!
 
!---
! solar zenith angle, (x) weights
!---

      IF (CSZ.LT.0.0) THEN
         ! OK sun below horizon
         CSZ = 0.0 
         RETURN 
      ENDIF

      IF (CSZ.LT.0.0 .OR. CSZ.GT.1.0) THEN
         PRINT *, 'bad solar zenith angle - ', CSZ
         RETURN 
      ENDIF
 
      I = 1
    2 CONTINUE
      IF (CSZ .LE. CSZS(I)) THEN
         I = I + 1
         GO TO 2
      ENDIF
      IF (I .LT. 5) THEN
         XL(1) = I - 1
         XL(2) = I
         XW(1) = (CSZS(XL(1))-CSZ)/(CSZS(XL(1))-CSZS(XL(2)))
         XW(2) = 1. - XW(1)
      ELSE IF (I .GT. 4) THEN
         DO J3 = 1, 2
            XL(J3) = 4
         END DO
         XW(1) = 0.0
         XW(2) = 1.0
      ENDIF
!---
! pw, (y) weights
!---
      I = 1
    3 CONTINUE
      IF (LNPW .LE. LNPWS(I)) THEN
         I = I + 1
         GO TO 3
      ENDIF
      IF (I .EQ. 1) THEN
         DO J3 = 1, 2
            YL(J3) = I
         END DO
         YW(1) = 1.0
         YW(2) = 0.0
      ELSE IF (I.GT.1 .AND. I.LT.4) THEN
         YL(1) = I - 1
         YL(2) = I
         YW(1) = (LNPWS(YL(1))-LNPW)/(LNPWS(YL(1))-LNPWS(YL(2)))
         YW(2) = 1. - YW(1)
      ELSE IF (I .GT. 3) THEN
         DO J3 = 1, 2
            YL(J3) = 3
         END DO
         YW(1) = 0.0
         YW(2) = 1.0
      ENDIF
 
      DO I = 1, 15
         A1 = WGTS(I,XL(1),YL(1))*XW(2) + WGTS(I,XL(2),YL(1))*XW(1)
         A2 = WGTS(I,XL(1),YL(2))*XW(2) + WGTS(I,XL(2),YL(2))*XW(1)
         WGT(I) = A1*YW(2) + A2*YW(1)
      END DO
 
 
 
      END 
