
      SUBROUTINE TZS(NLYR, DTAUC, SSALB, TEMPER, WVNMLO,
     &     WVNMHI, USRTAU, NTAU, UTAU, USRANG, NUMU,
     &     UMU, NPHI, PHI, 
     &     ALBEDO, BTEMP, TTEMP, TEMIS,
     &     PLANK, PRNT, HEADER, MAXCLY,
     &     MAXULV, MAXUMU, MAXPHI, RFLDIR, RFLDN,
     &     FLUP, DFDT, UAVG, UU, ALBMED, TRNMED,
     &     uavgdn, uavgso, uavgup )

c     .. Parameters ..
      INTEGER   MXCLY, MXULV, MXCMU, MXUMU, MXPHI
      INCLUDE  'DISORT.MXD'

c     .. Scalar Arguments ..
      CHARACTER HEADER*127
      LOGICAL   PLANK, USRANG, USRTAU
      INTEGER   MAXCLY, MAXPHI, MAXULV, MAXUMU, NLYR,
     &          NPHI, NTAU, NUMU
      REAL      ALBEDO, BTEMP, TEMIS, TTEMP, WVNMHI, WVNMLO

c     .. Array Arguments ..
      LOGICAL   PRNT( 5 )
      REAL      ALBMED( MAXUMU ), DFDT( MAXULV ), DTAUC( MAXCLY ),
     &          FLUP( MAXULV ), PHI( MAXPHI ), 
     &          RFLDIR( MAXULV ), RFLDN( MAXULV ), 
     &          TEMPER( 0:MAXCLY ), TRNMED( MAXUMU ), UAVG( MAXULV ),
     &          UMU( MAXUMU ), 
     &          UU( MAXUMU, MAXULV, MAXPHI ), 
     &          SSALB( MAXCLY ), UTAU( MAXULV )
      REAL      UAVGDN( MAXULV ), UAVGUP( MAXULV ), UAVGSO( MAXULV )

C    .. Internal variables
      INTEGER   LC, MAXEI, IE, J, IU, IT
C      PARAMETER (MAXEI=508)
      PARAMETER (MAXEI=1007)
      REAL*8      TAUC( 0:MXCLY ), EI_ARG( MAXEI ), EI( MAXEI )
      REAL*8      TAU1, TAU2, ETAU1, ETAU2, ETAUMU, EI1, EI2, RAD
      REAL*8      RADREFL, RADEM, PKAG( 0:MXCLY )
      REAL*8      B0, B1
      REAL*8      COEFF1, COEFF2
      REAL*8      SQTAU1, SQTAU2, MU
      INTEGER   LEV

c     .. External Functions ..
      REAL      PLKAVG2
      EXTERNAL  PLKAVG2

C     .. External Subroutines ..
      EXTERNAL  CHEKIN_TZS, PRTINP_TZS, FIND_ARG

c     .. Intrinsic Functions ..
      INTRINSIC ABS, ASIN, COS, FLOAT, LEN, MAX, SQRT

      SAVE      PI, RPD, SQT

      DATA      (EI_ARG(I), I=1,100)/
     &     0.000010, 0.000100, 0.001000, 0.010000, 0.0150,
     &     0.020000, 0.025000, 0.030000, 0.035000, 0.040000,
     &     0.045000, 0.050000, 0.055000, 0.060000, 0.065000,
     &     0.070000, 0.075000, 0.080000, 0.085000, 0.090000,
     &     0.095000, 0.100000, 0.105000, 0.110000, 0.115000,
     &     0.120000, 0.125000, 0.130000, 0.135000, 0.140000,
     &     0.145000, 0.150000, 0.155000, 0.160000, 0.165000,
     &     0.170000, 0.175000, 0.180000, 0.185000, 0.190000,
     &     0.195000, 0.200000, 0.205000, 0.210000, 0.215000,
     &     0.220000, 0.225000, 0.230000, 0.235000, 0.240000,
     &     0.245000, 0.250000, 0.255000, 0.260000, 0.265000,
     &     0.270000, 0.275000, 0.280000, 0.285000, 0.290000,
     &     0.295000, 0.300000, 0.305000, 0.310000, 0.315000,
     &     0.320000, 0.325000, 0.330000, 0.335000, 0.340000,
     &     0.345000, 0.350000, 0.355000, 0.360000, 0.365000,
     &     0.370000, 0.375000, 0.380000, 0.385000, 0.390000,
     &     0.395000, 0.400000, 0.405000, 0.410000, 0.415000,
     &     0.420000, 0.425000, 0.430000, 0.435000, 0.440000,
     &     0.445000, 0.450000, 0.455000, 0.460000, 0.465000,
     &     0.470000, 0.475000, 0.480000, 0.485000, 0.490000/
      DATA      (EI_ARG(I), I=101,200)/
     &     0.495000, 0.500000, 0.505000, 0.510000, 0.515000,
     &     0.520000, 0.525000, 0.530000, 0.535000, 0.540000,
     &     0.545000, 0.550000, 0.555000, 0.560000, 0.565000,
     &     0.570000, 0.575000, 0.580000, 0.585000, 0.590000,
     &     0.595000, 0.600000, 0.605000, 0.610000, 0.615000,
     &     0.620000, 0.625000, 0.630000, 0.635000, 0.640000,
     &     0.645000, 0.650000, 0.655000, 0.660000, 0.665000,
     &     0.670000, 0.675000, 0.680000, 0.685000, 0.690000,
     &     0.695000, 0.700000, 0.705000, 0.710000, 0.715000,
     &     0.720000, 0.725000, 0.730000, 0.735000, 0.740000,
     &     0.745000, 0.750000, 0.755000, 0.760000, 0.765000,
     &     0.770000, 0.775000, 0.780000, 0.785000, 0.790000,
     &     0.795000, 0.800000, 0.805000, 0.810000, 0.815000,
     &     0.820000, 0.825000, 0.830000, 0.835000, 0.840000,
     &     0.845000, 0.850000, 0.855000, 0.860000, 0.865000,
     &     0.870000, 0.875000, 0.880000, 0.885000, 0.890000,
     &     0.895000, 0.900000, 0.905000, 0.910000, 0.915000,
     &     0.920000, 0.925000, 0.930000, 0.935000, 0.940000,
     &     0.945000, 0.950000, 0.955000, 0.960000, 0.965000,
     &     0.970000, 0.975000, 0.980000, 0.985000, 0.990000/
      DATA      (EI_ARG(I), I=201,300)/
     &     0.995000, 1.000000, 1.005000, 1.010000, 1.015000,
     &     1.020000, 1.025000, 1.030000, 1.035000, 1.040000,
     &     1.045000, 1.050000, 1.055000, 1.060000, 1.065000,
     &     1.070000, 1.075000, 1.080000, 1.085000, 1.090000,
     &     1.095000, 1.100000, 1.105000, 1.110000, 1.115000,
     &     1.120000, 1.125000, 1.130000, 1.135000, 1.140000,
     &     1.145000, 1.150000, 1.155000, 1.160000, 1.165000,
     &     1.170000, 1.175000, 1.180000, 1.185000, 1.190000,
     &     1.195000, 1.200000, 1.205000, 1.210000, 1.215000,
     &     1.220000, 1.225000, 1.230000, 1.235000, 1.240000,
     &     1.245000, 1.250000, 1.255000, 1.260000, 1.265000,
     &     1.270000, 1.275000, 1.280000, 1.285000, 1.290000,
     &     1.295000, 1.300000, 1.305000, 1.310000, 1.315000,
     &     1.320000, 1.325000, 1.330000, 1.335000, 1.340000,
     &     1.345000, 1.350000, 1.355000, 1.360000, 1.365000,
     &     1.370000, 1.375000, 1.380000, 1.385000, 1.390000,
     &     1.395000, 1.400000, 1.405000, 1.410000, 1.415000,
     &     1.420000, 1.425000, 1.430000, 1.435000, 1.440000,
     &     1.445000, 1.450000, 1.455000, 1.460000, 1.465000,
     &     1.470000, 1.475000, 1.480000, 1.485000, 1.490000/
      DATA      (EI_ARG(I), I=301,400)/
     &     1.495000, 1.500000, 1.505000, 1.510000, 1.515000,
     &     1.520000, 1.525000, 1.530000, 1.535000, 1.540000,
     &     1.545000, 1.550000, 1.555000, 1.560000, 1.565000,
     &     1.570000, 1.575000, 1.580000, 1.585000, 1.590000,
     &     1.595000, 1.600000, 1.605000, 1.610000, 1.615000,
     &     1.620000, 1.625000, 1.630000, 1.635000, 1.640000,
     &     1.645000, 1.650000, 1.655000, 1.660000, 1.665000,
     &     1.670000, 1.675000, 1.680000, 1.685000, 1.690000,
     &     1.695000, 1.700000, 1.705000, 1.710000, 1.715000,
     &     1.720000, 1.725000, 1.730000, 1.735000, 1.740000,
     &     1.745000, 1.750000, 1.755000, 1.760000, 1.765000,
     &     1.770000, 1.775000, 1.780000, 1.785000, 1.790000,
     &     1.795000, 1.800000, 1.805000, 1.810000, 1.815000,
     &     1.820000, 1.825000, 1.830000, 1.835000, 1.840000,
     &     1.845000, 1.850000, 1.855000, 1.860000, 1.865000,
     &     1.870000, 1.875000, 1.880000, 1.885000, 1.890000,
     &     1.895000, 1.900000, 1.905000, 1.910000, 1.915000,
     &     1.920000, 1.925000, 1.930000, 1.935000, 1.940000,
     &     1.945000, 1.950000, 1.955000, 1.960000, 1.965000,
     &     1.970000, 1.975000, 1.980000, 1.985000, 1.990000/
      DATA      (EI_ARG(I), I=401,500)/
     &     1.995000, 2.000000, 2.005000, 2.010000, 2.015000,
     &     2.020000, 2.025000, 2.030000, 2.035000, 2.040000,
     &     2.045000, 2.050000, 2.055000, 2.060000, 2.065000,
     &     2.070000, 2.075000, 2.080000, 2.085000, 2.090000,
     &     2.095000, 2.100000, 2.105000, 2.110000, 2.115000,
     &     2.120000, 2.125000, 2.130000, 2.135000, 2.140000,
     &     2.145000, 2.150000, 2.155000, 2.160000, 2.165000,
     &     2.170000, 2.175000, 2.180000, 2.185000, 2.190000,
     &     2.195000, 2.200000, 2.205000, 2.210000, 2.215000,
     &     2.220000, 2.225000, 2.230000, 2.235000, 2.240000,
     &     2.245000, 2.250000, 2.255000, 2.260000, 2.265000,
     &     2.270000, 2.275000, 2.280000, 2.285000, 2.290000,
     &     2.295000, 2.300000, 2.305000, 2.310000, 2.315000,
     &     2.320000, 2.325000, 2.330000, 2.335000, 2.340000,
     &     2.345000, 2.350000, 2.355000, 2.360000, 2.365000,
     &     2.370000, 2.375000, 2.380000, 2.385000, 2.390000,
     &     2.395000, 2.400000, 2.405000, 2.410000, 2.415000,
     &     2.420000, 2.425000, 2.430000, 2.435000, 2.440000,
     &     2.445000, 2.450000, 2.455000, 2.460000, 2.465000,
     &     2.470000, 2.475000, 2.480000, 2.485000, 2.490000/
      DATA      (EI_ARG(I), I=501,600)/
     &     2.495000, 2.500000, 2.505000, 2.510000, 2.515000,
     &     2.520000, 2.525000, 2.530000, 2.535000, 2.540000,
     &     2.545000, 2.550000, 2.555000, 2.560000, 2.565000,
     &     2.570000, 2.575000, 2.580000, 2.585000, 2.590000,
     &     2.595000, 2.600000, 2.605000, 2.610000, 2.615000,
     &     2.620000, 2.625000, 2.630000, 2.635000, 2.640000,
     &     2.645000, 2.650000, 2.655000, 2.660000, 2.665000,
     &     2.670000, 2.675000, 2.680000, 2.685000, 2.690000,
     &     2.695000, 2.700000, 2.705000, 2.710000, 2.715000,
     &     2.720000, 2.725000, 2.730000, 2.735000, 2.740000,
     &     2.745000, 2.750000, 2.755000, 2.760000, 2.765000,
     &     2.770000, 2.775000, 2.780000, 2.785000, 2.790000,
     &     2.795000, 2.800000, 2.805000, 2.810000, 2.815000,
     &     2.820000, 2.825000, 2.830000, 2.835000, 2.840000,
     &     2.845000, 2.850000, 2.855000, 2.860000, 2.865000,
     &     2.870000, 2.875000, 2.880000, 2.885000, 2.890000,
     &     2.895000, 2.900000, 2.905000, 2.910000, 2.915000,
     &     2.920000, 2.925000, 2.930000, 2.935000, 2.940000,
     &     2.945000, 2.950000, 2.955000, 2.960000, 2.965000,
     &     2.970000, 2.975000, 2.980000, 2.985000, 2.990000/
      DATA      (EI_ARG(I), I=601,700)/
     &     2.995000, 3.000000, 3.005000, 3.010000, 3.015000,
     &     3.020000, 3.025000, 3.030000, 3.035000, 3.040000,
     &     3.045000, 3.050000, 3.055000, 3.060000, 3.065000,
     &     3.070000, 3.075000, 3.080000, 3.085000, 3.090000,
     &     3.095000, 3.100000, 3.105000, 3.110000, 3.115000,
     &     3.120000, 3.125000, 3.130000, 3.135000, 3.140000,
     &     3.145000, 3.150000, 3.155000, 3.160000, 3.165000,
     &     3.170000, 3.175000, 3.180000, 3.185000, 3.190000,
     &     3.195000, 3.200000, 3.205000, 3.210000, 3.215000,
     &     3.220000, 3.225000, 3.230000, 3.235000, 3.240000,
     &     3.245000, 3.250000, 3.255000, 3.260000, 3.265000,
     &     3.270000, 3.275000, 3.280000, 3.285000, 3.290000,
     &     3.295000, 3.300000, 3.305000, 3.310000, 3.315000,
     &     3.320000, 3.325000, 3.330000, 3.335000, 3.340000,
     &     3.345000, 3.350000, 3.355000, 3.360000, 3.365000,
     &     3.370000, 3.375000, 3.380000, 3.385000, 3.390000,
     &     3.395000, 3.400000, 3.405000, 3.410000, 3.415000,
     &     3.420000, 3.425000, 3.430000, 3.435000, 3.440000,
     &     3.445000, 3.450000, 3.455000, 3.460000, 3.465000,
     &     3.470000, 3.475000, 3.480000, 3.485000, 3.490000/
      DATA      (EI_ARG(I), I=701,800)/
     &     3.495000, 3.500000, 3.505000, 3.510000, 3.515000,
     &     3.520000, 3.525000, 3.530000, 3.535000, 3.540000,
     &     3.545000, 3.550000, 3.555000, 3.560000, 3.565000,
     &     3.570000, 3.575000, 3.580000, 3.585000, 3.590000,
     &     3.595000, 3.600000, 3.605000, 3.610000, 3.615000,
     &     3.620000, 3.625000, 3.630000, 3.635000, 3.640000,
     &     3.645000, 3.650000, 3.655000, 3.660000, 3.665000,
     &     3.670000, 3.675000, 3.680000, 3.685000, 3.690000,
     &     3.695000, 3.700000, 3.705000, 3.710000, 3.715000,
     &     3.720000, 3.725000, 3.730000, 3.735000, 3.740000,
     &     3.745000, 3.750000, 3.755000, 3.760000, 3.765000,
     &     3.770000, 3.775000, 3.780000, 3.785000, 3.790000,
     &     3.795000, 3.800000, 3.805000, 3.810000, 3.815000,
     &     3.820000, 3.825000, 3.830000, 3.835000, 3.840000,
     &     3.845000, 3.850000, 3.855000, 3.860000, 3.865000,
     &     3.870000, 3.875000, 3.880000, 3.885000, 3.890000,
     &     3.895000, 3.900000, 3.905000, 3.910000, 3.915000,
     &     3.920000, 3.925000, 3.930000, 3.935000, 3.940000,
     &     3.945000, 3.950000, 3.955000, 3.960000, 3.965000,
     &     3.970000, 3.975000, 3.980000, 3.985000, 3.990000/
      DATA      (EI_ARG(I), I=801,900)/
     &     3.995000, 4.000000, 4.005000, 4.010000, 4.015000,
     &     4.020000, 4.025000, 4.030000, 4.035000, 4.040000,
     &     4.045000, 4.050000, 4.055000, 4.060000, 4.065000,
     &     4.070000, 4.075000, 4.080000, 4.085000, 4.090000,
     &     4.095000, 4.100000, 4.105000, 4.110000, 4.115000,
     &     4.120000, 4.125000, 4.130000, 4.135000, 4.140000,
     &     4.145000, 4.150000, 4.155000, 4.160000, 4.165000,
     &     4.170000, 4.175000, 4.180000, 4.185000, 4.190000,
     &     4.195000, 4.200000, 4.205000, 4.210000, 4.215000,
     &     4.220000, 4.225000, 4.230000, 4.235000, 4.240000,
     &     4.245000, 4.250000, 4.255000, 4.260000, 4.265000,
     &     4.270000, 4.275000, 4.280000, 4.285000, 4.290000,
     &     4.295000, 4.300000, 4.305000, 4.310000, 4.315000,
     &     4.320000, 4.325000, 4.330000, 4.335000, 4.340000,
     &     4.345000, 4.350000, 4.355000, 4.360000, 4.365000,
     &     4.370000, 4.375000, 4.380000, 4.385000, 4.390000,
     &     4.395000, 4.400000, 4.405000, 4.410000, 4.415000,
     &     4.420000, 4.425000, 4.430000, 4.435000, 4.440000,
     &     4.445000, 4.450000, 4.455000, 4.460000, 4.465000,
     &     4.470000, 4.475000, 4.480000, 4.485000, 4.490000/
      DATA      (EI_ARG(I), I=901,1000)/
     &     4.495000, 4.500000, 4.505000, 4.510000, 4.515000,
     &     4.520000, 4.525000, 4.530000, 4.535000, 4.540000,
     &     4.545000, 4.550000, 4.555000, 4.560000, 4.565000,
     &     4.570000, 4.575000, 4.580000, 4.585000, 4.590000,
     &     4.595000, 4.600000, 4.605000, 4.610000, 4.615000,
     &     4.620000, 4.625000, 4.630000, 4.635000, 4.640000,
     &     4.645000, 4.650000, 4.655000, 4.660000, 4.665000,
     &     4.670000, 4.675000, 4.680000, 4.685000, 4.690000,
     &     4.695000, 4.700000, 4.705000, 4.710000, 4.715000,
     &     4.720000, 4.725000, 4.730000, 4.735000, 4.740000,
     &     4.745000, 4.750000, 4.755000, 4.760000, 4.765000,
     &     4.770000, 4.775000, 4.780000, 4.785000, 4.790000,
     &     4.795000, 4.800000, 4.805000, 4.810000, 4.815000,
     &     4.820000, 4.825000, 4.830000, 4.835000, 4.840000,
     &     4.845000, 4.850000, 4.855000, 4.860000, 4.865000,
     &     4.870000, 4.875000, 4.880000, 4.885000, 4.890000,
     &     4.895000, 4.900000, 4.905000, 4.910000, 4.915000,
     &     4.920000, 4.925000, 4.930000, 4.935000, 4.940000,
     &     4.945000, 4.950000, 4.955000, 4.960000, 4.965000,
     &     4.970000, 4.975000, 4.980000, 4.985000, 4.990000/
      DATA      (EI_ARG(I), I=1001,1007)/
     &     4.995000, 5.000000, 6.000000, 7.000000, 8.000000,
     &     9.000000, 10.000000/

      DATA (EI(I), I=1,100)/
     &     -10.935720, -8.633225, -6.331539, -4.037930,
     &     -3.637433, -3.354708, -3.136508, -2.959119,
     &     -2.809888, -2.681264, -2.568376, -2.467898,
     &     -2.377459, -2.295307, -2.220111, -2.150838,
     &     -2.086668, -2.026941, -1.971116, -1.918745,
     &     -1.869453, -1.822924, -1.778886, -1.737107,
     &     -1.697384, -1.659542, -1.623426, -1.588899,
     &     -1.555842, -1.524146, -1.493714, -1.464462,
     &     -1.436309, -1.409187, -1.383030, -1.357781,
     &     -1.333386, -1.309796, -1.286967, -1.264858,
     &     -1.243431, -1.222651, -1.202484, -1.182902,
     &     -1.163876, -1.145380, -1.127390, -1.109883,
     &     -1.092838, -1.076235, -1.060056, -1.044283,
     &     -1.028899, -1.013889, -0.999238, -0.984933,
     &     -0.970961, -0.957308, -0.943965, -0.930918,
     &     -0.918159, -0.905677, -0.893462, -0.881506,
     &     -0.869800, -0.858335, -0.847105, -0.836101,
     &     -0.825317, -0.814746, -0.804380, -0.794215,
     &     -0.784245, -0.774462, -0.764863, -0.755441,
     &     -0.746193, -0.737112, -0.728195, -0.719437,
     &     -0.710833, -0.702380, -0.694074, -0.685910,
     &     -0.677886, -0.669997, -0.662241, -0.654613,
     &     -0.647112, -0.639733, -0.632474, -0.625331,
     &     -0.618303, -0.611387, -0.604579, -0.597877,
     &     -0.591280, -0.584784, -0.578388, -0.572089/
      DATA (EI(I), I=101,300)/
     &     -0.565885, -0.559774, -0.553753, -0.547822,
     &     -0.541978, -0.536220, -0.530545, -0.524952,
     &     -0.519438, -0.514004, -0.508646, -0.503364,
     &     -0.498156, -0.493020, -0.487955, -0.482960,
     &     -0.478033, -0.473173, -0.468379, -0.463650,
     &     -0.458984, -0.454380, -0.449836, -0.445353,
     &     -0.440929, -0.436562, -0.432252, -0.427997,
     &     -0.423798, -0.419652, -0.415558, -0.411517,
     &     -0.407527, -0.403586, -0.399695, -0.395853,
     &     -0.392058, -0.388309, -0.384607, -0.380950,
     &     -0.377338, -0.373769, -0.370243, -0.366760,
     &     -0.363318, -0.359918, -0.356558, -0.353237,
     &     -0.349956, -0.346713, -0.343508, -0.340341,
     &     -0.337210, -0.334115, -0.331056, -0.328032,
     &     -0.325043, -0.322088, -0.319166, -0.316277,
     &     -0.313421, -0.310597, -0.307804, -0.305043,
     &     -0.302312, -0.299611, -0.296941, -0.294299,
     &     -0.291687, -0.289103, -0.286547, -0.284019,
     &     -0.281519, -0.279045, -0.276598, -0.274177,
     &     -0.271782, -0.269413, -0.267069, -0.264749,
     &     -0.262455, -0.260184, -0.257937, -0.255714,
     &     -0.253514, -0.251336, -0.249182, -0.247050,
     &     -0.244939, -0.242851, -0.240783, -0.238738,
     &     -0.236712, -0.234708, -0.232724, -0.230760,
     &     -0.228816, -0.226891, -0.224986, -0.223100,
     &     -0.221233, -0.219384, -0.217554, -0.215742,
     &     -0.213947, -0.212171, -0.210412, -0.208671,
     &     -0.206946, -0.205238, -0.203547, -0.201873,
     &     -0.200215, -0.198572, -0.196946, -0.195335,
     &     -0.193740, -0.192160, -0.190596, -0.189046,
     &     -0.187511, -0.185991, -0.184485, -0.182993,
     &     -0.181516, -0.180052, -0.178603, -0.177167,
     &     -0.175744, -0.174335, -0.172938, -0.171555,
     &     -0.170185, -0.168828, -0.167483, -0.166150,
     &     -0.164830, -0.163522, -0.162226, -0.160942,
     &     -0.159669, -0.158408, -0.157159, -0.155921,
     &     -0.154695, -0.153479, -0.152275, -0.151081,
     &     -0.149898, -0.148726, -0.147565, -0.146413,
     &     -0.145272, -0.144142, -0.143021, -0.141911,
     &     -0.140810, -0.139719, -0.138638, -0.137566,
     &     -0.136504, -0.135451, -0.134407, -0.133373,
     &     -0.132348, -0.131331, -0.130324, -0.129325,
     &     -0.128335, -0.127354, -0.126381, -0.125417,
     &     -0.124461, -0.123513, -0.122574, -0.121642,
     &     -0.120719, -0.119803, -0.118896, -0.117996,
     &     -0.117104, -0.116219, -0.115342, -0.114473,
     &     -0.113611, -0.112756, -0.111909, -0.111068,
     &     -0.110235, -0.109409, -0.108590, -0.107777,
     &     -0.106972, -0.106173, -0.105381, -0.104596,
     &     -0.103817, -0.103045, -0.102279, -0.101520/
      DATA (EI(I), I=301,500)/
     &     -0.100766, -0.100020, -0.099279, -0.098544,
     &     -0.097816, -0.097093, -0.096377, -0.095666,
     &     -0.094962, -0.094263, -0.093570, -0.092882,
     &     -0.092200, -0.091524, -0.090853, -0.090188,
     &     -0.089528, -0.088874, -0.088224, -0.087581,
     &     -0.086942, -0.086308, -0.085680, -0.085057,
     &     -0.084438, -0.083825, -0.083217, -0.082613,
     &     -0.082015, -0.081421, -0.080832, -0.080248,
     &     -0.079668, -0.079093, -0.078523, -0.077957,
     &     -0.077395, -0.076838, -0.076286, -0.075738,
     &     -0.075194, -0.074655, -0.074119, -0.073589,
     &     -0.073062, -0.072539, -0.072021, -0.071506,
     &     -0.070996, -0.070490, -0.069987, -0.069489,
     &     -0.068994, -0.068503, -0.068017, -0.067534,
     &     -0.067054, -0.066579, -0.066107, -0.065639,
     &     -0.065174, -0.064713, -0.064256, -0.063802,
     &     -0.063352, -0.062905, -0.062461, -0.062021,
     &     -0.061585, -0.061151, -0.060722, -0.060295,
     &     -0.059872, -0.059452, -0.059035, -0.058621,
     &     -0.058210, -0.057803, -0.057399, -0.056998,
     &     -0.056599, -0.056204, -0.055812, -0.055423,
     &     -0.055037, -0.054654, -0.054273, -0.053896,
     &     -0.053521, -0.053150, -0.052781, -0.052414,
     &     -0.052051, -0.051690, -0.051332, -0.050977,
     &     -0.050624, -0.050274, -0.049927, -0.049582,
     &     -0.049240, -0.048901, -0.048563, -0.048229,
     &     -0.047897, -0.047567, -0.047240, -0.046915,
     &     -0.046593, -0.046273, -0.045956, -0.045641,
     &     -0.045328, -0.045017, -0.044709, -0.044403,
     &     -0.044099, -0.043798, -0.043499, -0.043202,
     &     -0.042907, -0.042614, -0.042324, -0.042035,
     &     -0.041749, -0.041465, -0.041183, -0.040903,
     &     -0.040625, -0.040349, -0.040075, -0.039803,
     &     -0.039534, -0.039266, -0.039000, -0.038736,
     &     -0.038473, -0.038213, -0.037955, -0.037698,
     &     -0.037444, -0.037191, -0.036940, -0.036691,
     &     -0.036444, -0.036198, -0.035955, -0.035713,
     &     -0.035472, -0.035234, -0.034997, -0.034762,
     &     -0.034529, -0.034297, -0.034067, -0.033839,
     &     -0.033612, -0.033387, -0.033163, -0.032941,
     &     -0.032721, -0.032502, -0.032285, -0.032069,
     &     -0.031855, -0.031643, -0.031432, -0.031222,
     &     -0.031014, -0.030808, -0.030603, -0.030399,
     &     -0.030197, -0.029996, -0.029797, -0.029599,
     &     -0.029402, -0.029207, -0.029013, -0.028821,
     &     -0.028630, -0.028440, -0.028252, -0.028065,
     &     -0.027879, -0.027695, -0.027512, -0.027330,
     &     -0.027150, -0.026970, -0.026792, -0.026616,
     &     -0.026440, -0.026266, -0.026093, -0.025921,
     &     -0.025750, -0.025581, -0.025413, -0.025246/
      DATA (EI(I), I=501,700)/
     &     -0.025080, -0.024915, -0.024751, -0.024589,
     &     -0.024428, -0.024267, -0.024108, -0.023950,
     &     -0.023793, -0.023638, -0.023483, -0.023329,
     &     -0.023177, -0.023025, -0.022875, -0.022725,
     &     -0.022577, -0.022430, -0.022283, -0.022138,
     &     -0.021994, -0.021850, -0.021708, -0.021567,
     &     -0.021426, -0.021287, -0.021148, -0.021011,
     &     -0.020874, -0.020739, -0.020604, -0.020470,
     &     -0.020337, -0.020205, -0.020074, -0.019944,
     &     -0.019815, -0.019687, -0.019559, -0.019432,
     &     -0.019307, -0.019182, -0.019058, -0.018935,
     &     -0.018812, -0.018691, -0.018570, -0.018450,
     &     -0.018331, -0.018213, -0.018096, -0.017979,
     &     -0.017863, -0.017748, -0.017634, -0.017520,
     &     -0.017408, -0.017296, -0.017184, -0.017074,
     &     -0.016964, -0.016855, -0.016747, -0.016640,
     &     -0.016533, -0.016427, -0.016321, -0.016217,
     &     -0.016113, -0.016010, -0.015907, -0.015805,
     &     -0.015704, -0.015604, -0.015504, -0.015405,
     &     -0.015306, -0.015209, -0.015112, -0.015015,
     &     -0.014919, -0.014824, -0.014729, -0.014636,
     &     -0.014542, -0.014450, -0.014358, -0.014266,
     &     -0.014175, -0.014085, -0.013995, -0.013906,
     &     -0.013818, -0.013730, -0.013643, -0.013556,
     &     -0.013470, -0.013385, -0.013300, -0.013215,
     &     -0.013132, -0.013048, -0.012966, -0.012884,
     &     -0.012802, -0.012721, -0.012640, -0.012560,
     &     -0.012481, -0.012402, -0.012324, -0.012246,
     &     -0.012168, -0.012091, -0.012015, -0.011939,
     &     -0.011864, -0.011789, -0.011715, -0.011641,
     &     -0.011567, -0.011494, -0.011422, -0.011350,
     &     -0.011279, -0.011208, -0.011137, -0.011067,
     &     -0.010997, -0.010928, -0.010860, -0.010791,
     &     -0.010723, -0.010656, -0.010589, -0.010523,
     &     -0.010457, -0.010391, -0.010326, -0.010261,
     &     -0.010197, -0.010133, -0.010070, -0.010006,
     &     -0.009944, -0.009882, -0.009820, -0.009758,
     &     -0.009697, -0.009637, -0.009576, -0.009517,
     &     -0.009457, -0.009398, -0.009339, -0.009281,
     &     -0.009223, -0.009166, -0.009108, -0.009052,
     &     -0.008995, -0.008939, -0.008883, -0.008828,
     &     -0.008773, -0.008718, -0.008664, -0.008610,
     &     -0.008557, -0.008503, -0.008451, -0.008398,
     &     -0.008346, -0.008294, -0.008242, -0.008191,
     &     -0.008140, -0.008090, -0.008040, -0.007990,
     &     -0.007940, -0.007891, -0.007842, -0.007793,
     &     -0.007745, -0.007697, -0.007650, -0.007602,
     &     -0.007555, -0.007508, -0.007462, -0.007416,
     &     -0.007370, -0.007324, -0.007279, -0.007234,
     &     -0.007189, -0.007145, -0.007101, -0.007057/
      DATA (EI(I), I=701,900)/
     &     -0.007013, -0.006970, -0.006927, -0.006884,
     &     -0.006842, -0.006800, -0.006758, -0.006716,
     &     -0.006675, -0.006634, -0.006593, -0.006552,
     &     -0.006512, -0.006472, -0.006432, -0.006393,
     &     -0.006353, -0.006314, -0.006275, -0.006237,
     &     -0.006198, -0.006160, -0.006123, -0.006085,
     &     -0.006048, -0.006011, -0.005974, -0.005937,
     &     -0.005901, -0.005864, -0.005828, -0.005793,
     &     -0.005757, -0.005722, -0.005687, -0.005652,
     &     -0.005618, -0.005583, -0.005549, -0.005515,
     &     -0.005481, -0.005448, -0.005415, -0.005381,
     &     -0.005349, -0.005316, -0.005283, -0.005251,
     &     -0.005219, -0.005187, -0.005156, -0.005124,
     &     -0.005093, -0.005062, -0.005031, -0.005000,
     &     -0.004970, -0.004939, -0.004909, -0.004879,
     &     -0.004850, -0.004820, -0.004791, -0.004762,
     &     -0.004733, -0.004704, -0.004675, -0.004647,
     &     -0.004619, -0.004591, -0.004563, -0.004535,
     &     -0.004507, -0.004480, -0.004453, -0.004426,
     &     -0.004399, -0.004372, -0.004346, -0.004319,
     &     -0.004293, -0.004267, -0.004241, -0.004216,
     &     -0.004190, -0.004165, -0.004139, -0.004114,
     &     -0.004089, -0.004065, -0.004040, -0.004016,
     &     -0.003991, -0.003967, -0.003943, -0.003919,
     &     -0.003896, -0.003872, -0.003849, -0.003825,
     &     -0.003802, -0.003779, -0.003757, -0.003734,
     &     -0.003711, -0.003689, -0.003667, -0.003645,
     &     -0.003623, -0.003601, -0.003579, -0.003557,
     &     -0.003536, -0.003515, -0.003493, -0.003472,
     &     -0.003452, -0.003431, -0.003410, -0.003390,
     &     -0.003369, -0.003349, -0.003329, -0.003309,
     &     -0.003289, -0.003269, -0.003249, -0.003230,
     &     -0.003210, -0.003191, -0.003172, -0.003153,
     &     -0.003134, -0.003115, -0.003096, -0.003078,
     &     -0.003059, -0.003041, -0.003023, -0.003005,
     &     -0.002987, -0.002969, -0.002951, -0.002933,
     &     -0.002916, -0.002898, -0.002881, -0.002864,
     &     -0.002846, -0.002829, -0.002812, -0.002796,
     &     -0.002779, -0.002762, -0.002746, -0.002729,
     &     -0.002713, -0.002697, -0.002681, -0.002665,
     &     -0.002649, -0.002633, -0.002617, -0.002602,
     &     -0.002586, -0.002571, -0.002555, -0.002540,
     &     -0.002525, -0.002510, -0.002495, -0.002480,
     &     -0.002465, -0.002450, -0.002436, -0.002421,
     &     -0.002407, -0.002393, -0.002378, -0.002364,
     &     -0.002350, -0.002336, -0.002322, -0.002308,
     &     -0.002295, -0.002281, -0.002267, -0.002254,
     &     -0.002240, -0.002227, -0.002214, -0.002201,
     &     -0.002188, -0.002175, -0.002162, -0.002149,
     &     -0.002136, -0.002123, -0.002111, -0.002098/
      DATA (EI(I), I=901,1007)/
     &     -0.002086, -0.002073, -0.002061, -0.002049,
     &     -0.002037, -0.002025, -0.002013, -0.002001,
     &     -0.001989, -0.001977, -0.001965, -0.001954,
     &     -0.001942, -0.001931, -0.001919, -0.001908,
     &     -0.001896, -0.001885, -0.001874, -0.001863,
     &     -0.001852, -0.001841, -0.001830, -0.001819,
     &     -0.001809, -0.001798, -0.001787, -0.001777,
     &     -0.001766, -0.001756, -0.001745, -0.001735,
     &     -0.001725, -0.001715, -0.001704, -0.001694,
     &     -0.001684, -0.001674, -0.001665, -0.001655,
     &     -0.001645, -0.001635, -0.001626, -0.001616,
     &     -0.001606, -0.001597, -0.001588, -0.001578,
     &     -0.001569, -0.001560, -0.001550, -0.001541,
     &     -0.001532, -0.001523, -0.001514, -0.001505,
     &     -0.001497, -0.001488, -0.001479, -0.001470,
     &     -0.001462, -0.001453, -0.001444, -0.001436,
     &     -0.001428, -0.001419, -0.001411, -0.001402,
     &     -0.001394, -0.001386, -0.001378, -0.001370,
     &     -0.001362, -0.001354, -0.001346, -0.001338,
     &     -0.001330, -0.001322, -0.001314, -0.001307,
     &     -0.001299, -0.001291, -0.001284, -0.001276,
     &     -0.001269, -0.001261, -0.001254, -0.001247,
     &     -0.001239, -0.001232, -0.001225, -0.001218,
     &     -0.001211, -0.001204, -0.001196, -0.001189,
     &     -0.001182, -0.001176, -0.001169, -0.001162,
     &     -0.001155, -0.001148, -0.000360, -0.000115,
     &     -0.000038, -0.000012, -0.000004/
      
      IF( PRNT(1) .AND. LEN( HEADER ).NE.0 )
     &    WRITE( *,'(//,1X,100(''*''),/,A,/,1X,100(''*''))' )
     &    ' TZS: '//HEADER

C     Print input information
      IF( PRNT( 1 ) )
     &     CALL PRTINP_TZS(NLYR, DTAUC, SSALB, TEMPER,
     &     WVNMLO, WVNMHI, NTAU, UTAU, NUMU, UMU,
     &     NPHI, PHI, ALBEDO, BTEMP, TTEMP, TEMIS,
     &     TAUC )

C     Check input dimensions and variables
      CALL CHEKIN_TZS(NLYR, DTAUC, SSALB, TEMPER, WVNMLO,
     &     WVNMHI, USRTAU, NTAU, UTAU, USRANG,
     &     NUMU, UMU, NPHI, PHI, 
     &     ALBEDO, BTEMP, TTEMP,
     &     TEMIS, PLANK, 
     &     MAXCLY, MAXULV, MAXUMU, MAXPHI,
     &     MXCLY, MXULV, MXUMU, MXCMU, MXPHI)

C     Initialise everything to 0.
      DO IU=1,MAXUMU
         ALBMED(IU)=0.
         TRNMED(IU)=0.
         DO IT=1,MAXULV
            DO J=1,MAXPHI
               UU(IU,IT,J)=0.
            ENDDO
         ENDDO
      ENDDO
      DO IT=1,MAXULV
         DFDT(IT)=0.
         FLUP(IT)=0.
         RFLDIR(IT)=0.
         RFLDN(IT)=0.
         UAVG(IT)=0.
         UAVGDN(IT)=0.
         UAVGUP(IT)=0.
         UAVGSO(IT)=0.
      ENDDO

C     Calculate cumulative optical depth
C     Remark: layer 1 is the first layer from above=TOA
      TAUC(0)=0.
      DO LC = 1, NLYR
C        Compute absorption optical depth (no scattering)
         DTAUC( LC )=(1-SSALB(LC))*DTAUC( LC )
         TAUC( LC )=TAUC( LC-1 )+DBLE(DTAUC( LC ))
      ENDDO

C     Planck radiation from surface with emissivity=1-ALBEDO and temperature BTEMP
      BPLANK = (1-ALBEDO)*PLKAVG2( WVNMLO, WVNMHI, BTEMP )

C     Planck radiation for every level (not layer!) from 0 to NLYR
      DO LEV = 0, NLYR
         PKAG(LEV) = DBLE(PLKAVG2( WVNMLO, WVNMHI, TEMPER( LEV ) ))
      ENDDO
      
C     Loop over UMUs
      DO IU=1,NUMU

C        Double precision UMU
         MU=DBLE(UMU(IU))
C        Attenuation factor due to full atmospheric absorption in direction MU
         ETAUMU=EXP(-TAUC(NLYR)/MU)

C        Initialise RAD to 0.
         RAD=0.

C        Initialise tau1
         TAU1=TAUC(NLYR)

C        Contribution from atmosphere
         DO LC=0,NLYR-1

C           Assume linear variation of Planck radiation from one level
C           to the next one: Planck=B0+tau*B1
            B1=0.
            IF(DTAUC(LC+1).GT.1.E-4) 
     &           B1=(PKAG(LC+1)-PKAG(LC))/DTAUC(LC+1)
            B0=PKAG(LC)-TAUC(LC)*B1

            COEFF1=B0+TAUC(LC+1)*B1
            COEFF2=B0+TAUC(LC)*B1

C           Emission of atmosphere:
C           ***********************
C           Attenuation factors from TOA to levels LC+1 resp. LC
            ETAU1=EXP(-TAUC(LC+1)/MU)
            ETAU2=EXP(-TAUC(LC)/MU)
C           Radiation emitted from layer LC+1
C            RADEM=ETAU2*PKAG(LC)-ETAU1*PKAG(LC+1)+B1*MU*(ETAU2-ETAU1)
            RADEM=ETAU2*COEFF2-ETAU1*COEFF1+B1*MU*(ETAU2-ETAU1)

C           Reflection from surface:
C           ************************
            TAU2=TAU1
            TAU1=TAUC(NLYR)-TAUC(LC+1)

            ETAU1=EXP(-TAU1)
            ETAU2=EXP(-TAU2)

            CALL FIND_ARG(EI_ARG,MAXEI,TAU1,IE)         
            EI1=EI(IE-1)+(TAU1-EI_ARG(IE-1))*
     &           (EI(IE)-EI(IE-1))/(EI_ARG(IE)-EI_ARG(IE-1))

            CALL FIND_ARG(EI_ARG,MAXEI,TAU2,IE)         
            EI2=EI(IE-1)+(TAU2-EI_ARG(IE-1))*
     &           (EI(IE)-EI(IE-1))/(EI_ARG(IE)-EI_ARG(IE-1))

            SQTAU1=TAU1*TAU1
            SQTAU2=TAU2*TAU2

            RADREFL=ETAU1*COEFF1*(1.-TAU1)-COEFF1*SQTAU1*EI1-
     &           ETAU2*COEFF2*(1.-TAU2)+COEFF2*SQTAU2*EI2
            RADREFL=RADREFL+
     &           B1/3.*(ETAU1*(-2.+TAU1-SQTAU1)-TAU1*SQTAU1*EI1-
     &           ETAU2*(-2.+TAU2-SQTAU2)+TAU2*SQTAU2*EI2)

C            RADREFL=ETAU1*PKAG(LC+1)*(1.-TAU1)-PKAG(LC+1)*SQTAU1*EI1-
C     &           ETAU2*PKAG(LC)*(1.-TAU2)+PKAG(LC)*SQTAU2*EI2
C            RADREFL=RADREFL+
C     &           B1/3.*(ETAU1*(-2.+TAU1-SQTAU1)-TAU1*SQTAU1*EI1-
C     &           ETAU2*(-2.+TAU2-SQTAU2)+TAU2*SQTAU2*EI2)

            RAD=RAD+RADEM+ALBEDO*ETAUMU*RADREFL

         ENDDO

C        Contribution from surface (bottom):
C        ***********************************
         RAD=RAD+BPLANK*ETAUMU

         DO IT=1,NTAU
            DO J=1,NPHI
               UU(IU,IT,J)=REAL(RAD)
            ENDDO
         ENDDO

      ENDDO
            
      RETURN
      END
      

      SUBROUTINE FIND_ARG(ARR,N,X,I)

C     ARR must be an ordered array (increasing order)

      INTEGER N, I
      REAL*8  ARR(N), X

      I=1
      DO WHILE (ARR(I).LE.X.AND.I.LT.N)
         I=I+1
      ENDDO

      RETURN
      END


      SUBROUTINE CHEKIN_TZS(NLYR, DTAUC, SSALB, TEMPER, WVNMLO,
     &     WVNMHI, USRTAU, NTAU, UTAU, USRANG,
     &     NUMU, UMU, NPHI, PHI, 
     &     ALBEDO, BTEMP, TTEMP,
     &     TEMIS, PLANK, 
     &     MAXCLY, MAXULV, MAXUMU, MAXPHI, 
     &     MXCLY, MXULV, MXUMU, MXCMU, MXPHI)
      
c     Checks the input dimensions and variables

c     Calls- WRTBAD2, WRTDIM2, ERRMSG2
c     Called by- TZS
c     --------------------------------------------------------------------

c     .. Scalar Arguments ..
      LOGICAL   PLANK, USRANG, USRTAU
      LOGICAL   TEMPSTEPWARN
      INTEGER   MAXCLY, MAXPHI, MAXULV, MAXUMU, MXCLY,
     &          MXCMU, MXPHI, MXULV, MXUMU, NLYR, NPHI,
     &          NTAU, NUMU
      REAL      ALBEDO, BTEMP, TEMIS, TTEMP,
     &          UMU0, WVNMHI, WVNMLO

c     .. Array Arguments ..
      REAL      DTAUC( MAXCLY ), PHI( MAXPHI ),
     &          SSALB( MAXCLY ), UTAU( MAXULV ),
     &          TEMPER( 0:MAXCLY ), UMU( MAXUMU )

c     .. Local Scalars ..
      LOGICAL   INPERR
      INTEGER   IU, J, K, LC, LU, NUMSQT

c     .. External Functions ..
      LOGICAL   WRTBAD2, WRTDIM2
      EXTERNAL  WRTBAD2, WRTDIM2

c     .. External Subroutines ..
      EXTERNAL  ERRMSG2

c     .. Intrinsic Functions ..
      INTRINSIC ABS, MAX, MOD

      DATA      TEMPSTEPWARN / .True. /
      SAVE      TEMPSTEPWARN

      INPERR = .FALSE.

      IF( .NOT.PLANK ) INPERR = WRTBAD2( 'PLANK' )

      IF( NLYR.LT.1 ) INPERR = WRTBAD2( 'NLYR' )

      IF( NLYR.GT.MAXCLY ) INPERR = WRTBAD2( 'MAXCLY' )

      DO LC = 1, NLYR

         IF( DTAUC( LC ).LT.0.0 ) INPERR = WRTBAD2( 'DTAUC' )

         IF( SSALB( LC ).LT.0.0 .OR. SSALB( LC ).GT.1.0 )
     &       INPERR = WRTBAD2( 'SSALB' )

         IF( TEMPER( LC ).LT.0.0 ) INPERR = WRTBAD2( 'TEMPER' )

      ENDDO

      IF( MAXULV.LT.1 ) INPERR = WRTBAD2( 'MAXULV' )

      IF ( USRTAU ) THEN

         IF( NTAU.NE.1 ) INPERR = WRTBAD2( 'NTAU' )

         IF ( NTAU.EQ.1 .AND. UTAU(1).NE.0. ) 
     &        INPERR = WRTBAD2( 'UTAU' )

      ELSE
         
         NTAU=1
         UTAU(1)=0.

      ENDIF

      IF( USRANG ) THEN

         IF( NUMU.LT.0 ) INPERR = WRTBAD2( 'NUMU' )

         IF( NUMU.GT.MAXUMU ) INPERR = WRTBAD2( 'MAXUMU' )

         DO IU = 1, NUMU

            IF( UMU( IU ).LT.-1.0 .OR. UMU( IU ).GT.1.0 .OR.
     &          UMU( IU ).EQ.0.0 ) INPERR = WRTBAD2( 'UMU' )

            IF( IU.GT.1 ) THEN

               IF( UMU( IU ).LT.UMU( IU-1 ) ) INPERR = WRTBAD2( 'UMU' )

            END IF

         ENDDO

         IF( NPHI.LE.0 ) INPERR = WRTBAD2( 'NPHI' )
         
         IF( NPHI.GT.MAXPHI ) INPERR = WRTBAD2( 'MAXPHI' )
      
         DO J = 1, NPHI
            
            IF( PHI( J ).LT.0.0 .OR. PHI( J ).GT.360.0 )
     &           INPERR = WRTBAD2( 'PHI' )
            
         ENDDO


      ELSE

         NUMU=1
         UMU(1)=1.
         NPHI=1
         PHI(1)=0.

      ENDIF

      IF( ALBEDO.LT.0.0 .OR. ALBEDO.GT.1.0 )
     &     INPERR = WRTBAD2( 'ALBEDO' )
      
      IF( WVNMLO.LT.0.0 .OR. WVNMHI.LE.WVNMLO )
     &     INPERR = WRTBAD2( 'WVNMLO,HI' )

      IF( TEMIS.LT.0.0 .OR. TEMIS.GT.1.0 ) INPERR=WRTBAD2( 'TEMIS' )

      IF( BTEMP.LT.0.0 ) INPERR = WRTBAD2( 'BTEMP' )
      
      IF( TTEMP.LT.0.0 ) INPERR = WRTBAD2( 'TTEMP' )

      IF( MXCLY.LT.NLYR ) INPERR = WRTDIM2( 'MXCLY', NLYR )

      IF( MXULV.LT.1 )
     &     INPERR = WRTDIM2( 'MXULV', NTAU )
      
      IF( INPERR )
     &   CALL ERRMSG2( 'TZS--input and/or dimension errors', .True. )

      DO LC = 1, NLYR

         IF( ABS( TEMPER( LC )-TEMPER( LC-1 ) ) .GT. 10.0 .AND. 
     &        TEMPSTEPWARN) THEN
            CALL ERRMSG2('CHEKIN_TZS--vertical temperature step may'
     &        //' be too large for good accuracy',
     &        .False. )
            TEMPSTEPWARN = .FALSE.
         ENDIF          

      ENDDO

      RETURN
      END


      SUBROUTINE PRTINP_TZS(NLYR, DTAUC, SSALB, TEMPER,
     &     WVNMLO, WVNMHI, NTAU, UTAU, NUMU, UMU,
     &     NPHI, PHI, ALBEDO, BTEMP, TTEMP, TEMIS,
     &     TAUC )
      
c     Print values of input variables

c   Called by- TZS
c --------------------------------------------------------------------

c     .. Scalar Arguments ..
      INTEGER   NLYR, NPHI, NTAU, NUMU
      REAL      ALBEDO, BTEMP, TEMIS, TTEMP, WVNMHI, WVNMLO

c     .. Array Arguments ..
      REAL      DTAUC( * ), PHI( * ), SSALB( * ),
     &          TEMPER( 0:* ), UMU( * ), UTAU( * )
      REAL*8    TAUC( 0:* )

c     .. Local Scalars ..
      INTEGER   IU, J, LC, LU

      WRITE( *, '(/,A,I4)' ) ' No. computational layers =', NLYR

      WRITE( *, '(I4,A,10F10.4,/,(26X,10F10.4))' )
     &    NTAU, ' User optical depths :', ( UTAU(LU), LU = 1, NTAU )

      WRITE( *, '(I4,A,10F9.5,/,(31X,10F9.5))' )
     &    NUMU, ' User polar angle cosines :', ( UMU(IU), IU = 1, NUMU )

      WRITE( *, '(I4,A,10F9.2,/,(28X,10F9.2))' )
     &           NPHI,' User azimuthal angles :',( PHI(J), J = 1, NPHI )
      
      WRITE( *, '(A,2F14.4,/,A,F10.2,A,F10.2,A,F8.4)' )
     &     '    Thermal emission in wavenumber interval :', WVNMLO,
     &     WVNMHI,
     &     '    Bottom temperature =', BTEMP,
     &     '    Top temperature =', TTEMP,
     &     '    Top emissivity =', TEMIS

      WRITE( *, '(A,0P,F8.4)' )
     &          '    Bottom albedo (Lambertian) =', ALBEDO

c     Print layer variables
c     (to read, skip every other line)

      WRITE( *, '(/,3(/,A))' )
     &  '                   Total    Single',
     &  '       Optical   Optical   Scatter',
     &  '         Depth     Depth    Albedo   Temperature'

      DO LC = 1, NLYR

         WRITE( *,'(I4,2F10.4,F10.5,F14.3)')
     &        LC, DTAUC( LC ), TAUC( LC ), SSALB( LC ),TEMPER( LC-1 )
         
      ENDDO

      WRITE( *, '(34X,F14.3)' ) TEMPER( NLYR )

      RETURN
      END
